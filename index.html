<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Dashboard Transjakarta</title>
    <link href="map.html" rel="import"/>
    <link href="index.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
    <script src="index.js"></script>
    <script>
      $(function(){
        $("#tranjakartaMap").load("map.html");
      });
    </script> 
  </head>
  <body>
    <div class="navbar">
      <button class="btn btn-active" id="koridor0" onclick="clickButton(this.id)">All</button>
      <button class="btn" id="koridor1" onclick="clickButton(this.id)">Koridor 1</button>
      <button class="btn" id="koridor2" onclick="clickButton(this.id)">Koridor 2</button>
      <button class="btn" id="koridor3" onclick="clickButton(this.id)">Koridor 3</button>
      <button class="btn" id="koridor4" onclick="clickButton(this.id)">Koridor 4</button>
      <button class="btn" id="koridor5" onclick="clickButton(this.id)">Koridor 5</button>
      <button class="btn" id="koridor6" onclick="clickButton(this.id)">Koridor 6</button>
      <button class="btn" id="koridor7" onclick="clickButton(this.id)">Koridor 7</button>
      <button class="btn" id="koridor8" onclick="clickButton(this.id)">Koridor 8</button>
      <button class="btn" id="koridor9" onclick="clickButton(this.id)">Koridor 9</button>
      <button class="btn" id="koridor10" onclick="clickButton(this.id)">Koridor 10</button>
      <button class="btn" id="koridor11" onclick="clickButton(this.id)">Koridor 11</button>
      <button class="btn" id="koridor12" onclick="clickButton(this.id)">Koridor 12</button>
      <button class="btn" id="koridor13" onclick="clickButton(this.id)">Koridor 13</button>
    </div>
    <div class="content">
      <div class="mapContainer">
        <div id="tranjakartaMap"></div>
        <div class="description"></div>
      </div>
      <div class="chartContainer">
        <h3>Penumpang</h3>
        <canvas id="chart1"></canvas>
        <h3>Pendapatan</h3>
        <canvas id="chart2"></canvas>
      </div>
    </div>
    <script>
      $(document).ready(function(){
        $.getJSON('data.json', function(result) {
          const n = [null];
          var p19 = n.concat(result.map(el => el['penumpang']['2019']));
          var p20 = n.concat(result.map(el => el['penumpang']['2020']));
          var d19 = n.concat(result.map(el => el['pendapatan']['2019']));
          var d20 = n.concat(result.map(el => el['pendapatan']['2020']));

          var labels = [null];
          for (let i = 1; i < 14; i++) {
            labels.push("Koridor " + i.toString());
          }
          labels.push(null);

          const data1 = {
            labels: labels,
            datasets: [
              {
                label: '2019',
                data: p19,
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
              },
              {
                label: '2020',
                data: p20,
                fill: false,
                borderColor: 'rgb(22, 22, 22)',
                tension: 0.1
              },
            ]
          };

          const data2 = {
            labels: labels,
            datasets: [
              {
                label: '2019',
                data: d19,
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
              },
              {
                label: '2020',
                data: d20,
                fill: false,
                borderColor: 'rgb(22, 22, 22)',
                tension: 0.1
              },
            ]
          };
        
          const config1 = {
            type: 'line',
            data: data1,
            options: {}
          };
        
          const config2 = {
            type: 'line',
            data: data2,
            options: {}
          };

          const chart1 = new Chart(
            document.getElementById('chart1'),
            config1
          );

          const chart2 = new Chart(
            document.getElementById('chart2'),
            config2
          );
        });
      });
    </script>
  </body>
</html>
